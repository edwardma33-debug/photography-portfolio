# Edward Ma Photography Portfolio

A permanent, archival-quality photography portfolio with deep-zoom viewing for medium format images.

## Features

- **Deep-zoom viewing** — OpenSeadragon-powered viewer lets visitors zoom to pixel level on your 100MP images
- **Visually lossless previews** — High-quality WebP/JPEG at every viewing stage
- **Lossless master downloads** — Full-resolution TIFF files available for download
- **Metadata preservation** — All EXIF data extracted and displayed
- **Static architecture** — No database, no server dependencies, hostable anywhere forever
- **Collection organization** — Automatic grouping from folder structure

## Architecture

```
portfolio/
├── app/                    # Next.js pages
├── components/             # React components
├── lib/                    # Types and utilities
├── public/
│   └── data/
│       └── gallery.json    # Image manifest (generated)
├── scripts/
│   └── process_images.py   # Image processing pipeline
└── [processed images]      # Generated by script
    ├── thumbnails/         # WebP, ~800px
    ├── previews/           # JPEG, ~2400px  
    ├── tiles/              # DZI pyramid for each image
    └── masters/            # Original TIFFs
```

## Quick Start

### 1. Install Dependencies

```bash
# Project dependencies
cd portfolio
npm install

# Python dependencies for image processing
pip install Pillow pyvips
```

**Note for macOS:** pyvips requires libvips. Install with:
```bash
brew install vips
```

**Note for Windows:** Download libvips from https://github.com/libvips/libvips/releases

### 2. Prepare Your Images

Export from Lightroom as TIFF:
- Color Space: sRGB or Adobe RGB
- Bit Depth: 16-bit (preserves quality)
- Compression: None or LZW

**Naming convention:**
```
"Street Scene - Beijing.tiff"
"Temple at Dawn - Kyoto.tiff"
"Cityscape.tiff"
```

**For collections**, organize into folders:
```
exports/
├── china/
│   ├── Street Scene - Beijing.tiff
│   └── Dystopia - Chongqing.tiff
├── japan/
│   └── Temple at Dawn - Kyoto.tiff
└── uncategorized/
    └── Random Shot.tiff
```

### 3. Process Images

```bash
python scripts/process_images.py \
  --input /path/to/lightroom/exports \
  --output ./public
```

This generates:
- Thumbnails (800px WebP)
- Previews (2400px JPEG)
- DZI tiles (for deep zoom)
- Copies of masters
- `gallery.json` manifest

### 4. Local Development

```bash
npm run dev
```

Visit http://localhost:3000

### 5. Deploy to Vercel

```bash
# Install Vercel CLI
npm i -g vercel

# Deploy
vercel
```

## Cloud Storage Setup (Required for Large Galleries)

Vercel has a 100MB function size limit. For large images, you'll need external storage.

### Recommended: Cloudflare R2 (No Egress Fees!)

1. Create a Cloudflare account
2. Create an R2 bucket
3. Enable public access or set up a custom domain
4. Upload your processed `thumbnails/`, `previews/`, `tiles/`, and `masters/` folders

Then update your processing command:
```bash
python scripts/process_images.py \
  --input ./exports \
  --output ./public \
  --storage-url https://your-bucket.r2.cloudflarestorage.com
```

### Upload to R2

Using rclone (recommended for large uploads):
```bash
# Configure rclone
rclone config
# Choose "s3" and enter R2 credentials

# Sync
rclone sync ./public/thumbnails r2:your-bucket/thumbnails
rclone sync ./public/previews r2:your-bucket/previews
rclone sync ./public/tiles r2:your-bucket/tiles
rclone sync ./public/masters r2:your-bucket/masters
```

## Permanence Strategy

### The Problem

Nothing digital lasts forever without active maintenance:
- Companies go bankrupt
- Hosting services shut down
- Domains expire
- File formats become obsolete

### The Approach

**1. Static Site Architecture**
- No database, no server-side code
- Pure HTML/CSS/JS can be hosted anywhere
- Can be opened directly from files if needed

**2. Standard File Formats**
- TIFF masters (universal archival format)
- WebP/JPEG derivatives (widely supported)
- JSON metadata (human-readable)

**3. Multiple Redundancy Layers**

| Layer | Purpose | Implementation |
|-------|---------|----------------|
| Primary | Daily access | Vercel + Cloudflare R2 |
| Geographic | Disaster recovery | Backblaze B2 (different region) |
| Offline | Local backup | External SSD + M-DISC |
| Decentralized | Censorship-resistant | IPFS/Arweave (optional) |

**4. IPFS Pinning (Optional)**

For truly permanent storage, pin your files to IPFS:
```bash
# Install IPFS Desktop or CLI
ipfs add -r ./public

# Pin with a pinning service
# Pinata, Web3.Storage, or Filebase
```

The IPFS CID (content hash) is permanent — as long as anyone pins the content, it exists.

**5. Documentation**

Include a `PRESERVATION.md` file explaining:
- What this archive is
- How to rebuild the site
- How to access the images directly
- Contact information

## Cost Estimates

| Service | Free Tier | Typical Monthly |
|---------|-----------|-----------------|
| Vercel (hosting) | Generous | $0 |
| Cloudflare R2 | 10GB storage, 10M requests | ~$5-15 for 100GB |
| Backblaze B2 | 10GB | ~$5 for 100GB |
| Domain | — | ~$12/year |

For a gallery of ~500 100MB images (50GB total):
- **First year:** ~$80 (domain + storage)
- **Ongoing:** ~$70/year

## Updating the Gallery

1. Export new images from Lightroom
2. Run the processing script
3. Push to git (triggers Vercel rebuild)
4. Sync new files to cloud storage

```bash
# Add new images
python scripts/process_images.py -i ./new_exports -o ./public

# Deploy
git add .
git commit -m "Add new images"
git push

# Sync to R2
rclone sync ./public/thumbnails r2:bucket/thumbnails --progress
rclone sync ./public/previews r2:bucket/previews --progress
rclone sync ./public/tiles r2:bucket/tiles --progress
rclone sync ./public/masters r2:bucket/masters --progress
```

## Customization

### Site Title & Metadata

Edit `app/layout.tsx`:
```tsx
export const metadata: Metadata = {
  title: 'Your Name — Photography',
  description: 'Your description',
}
```

### Colors & Fonts

Edit `app/globals.css` and `tailwind.config.js`

### Gallery Layout

The masonry grid is defined in `globals.css`. Adjust column counts:
```css
@media (min-width: 1024px) {
  .masonry-grid {
    column-count: 3;  /* Change this */
  }
}
```

## Keyboard Shortcuts (Viewer)

| Key | Action |
|-----|--------|
| `Esc` | Close viewer |
| `←` `→` | Previous/Next image |
| `+` `-` | Zoom in/out |
| `0` | Reset zoom |
| `I` | Toggle metadata panel |

## License

Your photographs remain your property. The code is MIT licensed.
